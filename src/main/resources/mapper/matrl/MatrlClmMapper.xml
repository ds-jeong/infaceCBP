<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.pe.inface.hub.service.matrl.mapper.MatrlClmMapper">

<!-- 자재청구목록 조회 -->
<select id="getMatrlClmList" parameterType="MatrlClmVO" resultType="MatrlClmVO"><![CDATA[
/* matrl.MatrlClmMapper.getMatrlClmList */
SELECT
        MC.MATRL_CLM_NO, MC.CMPNY_ID
      , MC.CLM_STAT_CD, MC.CLM_DT
      , MC.WORK_SITE_ID, WS.SITE_NM
FROM
        MATRL_CLM MC
        LEFT OUTER JOIN WORK_SITE WS ON WS.WORK_SITE_ID = MC.WORK_SITE_ID
WHERE   1 = 1
AND     MC.CMPNY_ID = #{cmpnyId, jdbcType=VARCHAR}
AND     ( #{workSiteId, jdbcType=VARCHAR} IS NULL OR MC.WORK_SITE_ID = #{workSiteId, jdbcType=VARCHAR} )
AND     ( #{clmStatCd, jdbcType=VARCHAR} IS NULL OR MC.CLM_STAT_CD = #{clmStatCd, jdbcType=VARCHAR} )
AND     CLM_DT >= #{clmDt, jdbcType=VARCHAR}
ORDER BY
        CLM_DT DESC
      , MATRL_CLM_NO DESC
]]></select>


<!-- 자재청구 조회 -->
<select id="getMatrlClm" parameterType="String" resultType="MatrlClmVO"><![CDATA[
/* matrl.MatrlClmMapper.getMatrlClm */
SELECT
		MATRL_CLM_NO, CLM_STAT_CD, CLM_DT
      , CLM_CHARGR_ID, REMARK
      , IN_ADDR_ZIPCD, IN_ADDR
      , IN_ADDR_REMARK, IN_GATE_NO
      , IN_CHARGR_NM, IN_CHARGR_TEL
      , IN_REMARK
      , WORK_SITE_ID, CMPNY_ID
FROM
        MATRL_CLM MC
WHERE   1 = 1
AND     MATRL_CLM_NO = #{matrlClmNo, jdbcType=VARCHAR}
]]></select>


<!-- 자재청구상세 목록 조회 -->
<select id="getMatrlClmDtlList" parameterType="String" resultType="MatrlClmVO"><![CDATA[
/* matrl.MatrlClmMapper.getMatrlClmDtlList */
SELECT
		MATRL_CLM_NO, MATRL_ID
	  , MATRL_CLM_DTL_NO, CLM_DTL_STAT_CD
      , IN_HOPE_DT
      , PREV_CLM_QTY, CLM_QTY, APRV_QTY
      , REQ_DESC, REMARK
FROM
        MATRL_CLM_DTL MCD
WHERE   1 = 1
AND     MATRL_CLM_NO = #{matrlClmNo, jdbcType=VARCHAR}
ORDER BY
        MATRL_CLM_DTL_NO
]]></select>


<!-- 자재청구승인 목록 조회 -->
<select id="getMatrlClmAprvList" parameterType="String" resultType="MatrlClmAprvVO"><![CDATA[
/* matrl.MatrlClmMapper.getMatrlClmAprvList */
SELECT
        MATRL_CLM_NO, APRV_SEQ
      , APRVR_ID, APRV_STAT_CD
      , RECV_DTS, APRV_DTS
      , REMARK
FROM
        MATRL_CLM_APRV MCA
WHERE   1 = 1
AND     MATRL_CLM_NO = #{matrlClmNo, jdbcType=VARCHAR}
ORDER BY
        APRV_SEQ
]]></select>


<!-- 자재청구파일 목록 조회 -->
<select id="getMatrlClmFileList" parameterType="String" resultType="MatrlClmFileVO"><![CDATA[
/* matrl.MatrlClmMapper.getMatrlClmFileList */
SELECT
        MATRL_CLM_NO, FILE_SEQ
      , USE_YN
      , FILE_DESC, FILE_PATH
FROM
        MATRL_CLM_FILE MCF
WHERE   1 = 1
AND     MATRL_CLM_NO = #{matrlClmNo, jdbcType=VARCHAR}
AND     USE_YN = 'Y'
ORDER BY
        FILE_SEQ
]]></select>

</mapper>
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.co.inface.hub.service.matrl.mapper.MatrlMapperTrx">

<!-- 업체 자재품목 설정 -->
<update id="useMyMatrlItem" parameterType="MatrlVO"><![CDATA[
/* matrl.MatrlMapperTrx.useMyMatrlItem */
INSERT
INTO    CMPNY_MATRL_ITEM
    (
        CMPNY_ID
      , MATRL_ITEM_ID
      , BUY_TYPE_CD
      , USE_YN
      , REGPE_ID
      , REG_DTS
      , MODPE_ID
      , MOD_DTS
    )
VALUES
    (
        #{cmpnyId, jdbcType=VARCHAR}
      , #{matrlItemId, jdbcType=VARCHAR}
      , #{buyTypeCd, jdbcType=VARCHAR}
      , #{useYn, jdbcType=VARCHAR}
      , #{userId, jdbcType=VARCHAR}
      , CURRENT_TIMESTAMP
      , #{userId, jdbcType=VARCHAR}
      , CURRENT_TIMESTAMP
    )
ON CONFLICT
    (
        CMPNY_ID
      , MATRL_ITEM_ID
    )
DO UPDATE
SET     BUY_TYPE_CD = #{buyTypeCd, jdbcType=VARCHAR}
      , USE_YN = #{useYn, jdbcType=VARCHAR}
      , MODPE_ID = #{userId, jdbcType=VARCHAR}
      , MOD_DTS = CURRENT_TIMESTAMP
]]></update>


<!-- 자재품목 공급업체 계약 설정 -->
<update id="updMatrlItemCntrtStat" parameterType="MatrlCntrtVO"><![CDATA[
/* matrl.MatrlMapperTrx.updMatrlItemCntrtStat */
INSERT
INTO    CMPNY_MATRL_ITEM_CNTRT
    (
        CMPNY_ID
      , MATRL_ITEM_ID
      , SPL_CMPNY_ID
      , BUY_TYPE_CD
      , CNTRT_STAT_CD
      , REGPE_ID
      , REG_DTS
      , MODPE_ID
      , MOD_DTS
    )
VALUES
    (
        #{cmpnyId, jdbcType=VARCHAR}
      , #{matrlItemId, jdbcType=VARCHAR}
      , #{splCmpnyId, jdbcType=VARCHAR}
      , #{buyTypeCd, jdbcType=VARCHAR}
      , #{cntrtStatCd, jdbcType=VARCHAR}
      , #{userId, jdbcType=VARCHAR}
      , CURRENT_TIMESTAMP
      , #{userId, jdbcType=VARCHAR}
      , CURRENT_TIMESTAMP
    )
ON CONFLICT
    (
        CMPNY_ID
      , MATRL_ITEM_ID
      , SPL_CMPNY_ID
      , BUY_TYPE_CD
    )
DO UPDATE
SET     CNTRT_STAT_CD = #{cntrtStatCd, jdbcType=VARCHAR}
      , MODPE_ID = #{userId, jdbcType=VARCHAR}
      , MOD_DTS = CURRENT_TIMESTAMP
]]></update>

</mapper>